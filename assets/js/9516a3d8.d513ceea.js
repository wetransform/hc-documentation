"use strict";(self.webpackChunkhc_documentation=self.webpackChunkhc_documentation||[]).push([[6548],{5680:(e,t,n)=>{n.d(t,{xA:()=>c,yg:()=>m});var a=n(6540);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),p=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=p(e.components);return a.createElement(l.Provider,{value:t},e.children)},d="mdxType",f={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},h=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=p(n),h=r,m=d["".concat(l,".").concat(h)]||d[h]||f[h]||i;return n?a.createElement(m,o(o({ref:t},c),{},{components:n})):a.createElement(m,o({ref:t},c))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=h;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[d]="string"==typeof e?e:r,o[1]=s;for(var p=2;p<i;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}h.displayName="MDXCreateElement"},8552:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>f,frontMatter:()=>i,metadata:()=>s,toc:()=>p});var a=n(8168),r=(n(6540),n(5680));const i={title:"Preparing ESRI shapefiles for online transformation",categories:["help-page-category-tutorials","help-page-subcategory-tutorials"],layout:"help-detail",language:"en"},o=void 0,s={unversionedId:"tutorials/2018-05-04-shp-tutorial",id:"tutorials/2018-05-04-shp-tutorial",title:"Preparing ESRI shapefiles for online transformation",description:"ESRI Shapefile format",source:"@site/docs/tutorials/2018-05-04-shp-tutorial.md",sourceDirName:"tutorials",slug:"/tutorials/2018-05-04-shp-tutorial",permalink:"/docs/tutorials/2018-05-04-shp-tutorial",draft:!1,editUrl:"https://github.com/wetransform/hc-documentation/tree/master/docs/tutorials/2018-05-04-shp-tutorial.md",tags:[],version:"current",frontMatter:{title:"Preparing ESRI shapefiles for online transformation",categories:["help-page-category-tutorials","help-page-subcategory-tutorials"],layout:"help-detail",language:"en"},sidebar:"tutorialSidebar",previous:{title:"Creating Styled Layer Descriptor files (SLDs) for hale\xbbconnect",permalink:"/docs/tutorials/2018-05-03-sld-tutorial"},next:{title:"Creating a profile using the hale\xbbconnect Profile Management Tool (PMT)",permalink:"/docs/tutorials/2018-05-05-pmt-tutorial"}},l={},p=[{value:"<strong>ESRI Shapefile format</strong>",id:"esri-shapefile-format",level:3},{value:"<strong>Datum transformations</strong>",id:"datum-transformations",level:3},{value:"<strong>Coordinate reference system identification in hale\xbbconnect</strong>",id:"coordinate-reference-system-identification-in-haleconnect",level:3},{value:"<strong>Manually adding the AUTHORITY parameter to an ESRI prj file</strong>",id:"manually-adding-the-authority-parameter-to-an-esri-prj-file",level:3},{value:"<strong>Axis flip</strong>",id:"axis-flip",level:3}],c={toc:p},d="wrapper";function f(e){let{components:t,...n}=e;return(0,r.yg)(d,(0,a.A)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.yg)("h3",{id:"esri-shapefile-format"},(0,r.yg)("strong",{parentName:"h3"},"ESRI Shapefile format")),(0,r.yg)("p",null,"The ESRI shapefile is a vector data storage format comprised of three files with the same file name prefix:"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"shp: stores the geometry as a list of vertices"),(0,r.yg)("li",{parentName:"ul"},"shx: index of the geometry to enable fast, index-based searches"),(0,r.yg)("li",{parentName:"ul"},"dbf: dBase file used to store attribute information")),(0,r.yg)("p",null,"Shapefiles may have additional files, such as ",(0,r.yg)("inlineCode",{parentName:"p"},".prj")," which stores coordinate system information (used by ArcGIS), or ",(0,r.yg)("inlineCode",{parentName:"p"},".cpg")," which specifies the code page for identifying the character set to be used. By definition, a vector is a Cartesian-based (i.e. X,Y) data structure used to store spatial data. Most geographic information systems, including ESRI's ArcGIS, store geospatial data in vector format. Other common spatial data formats include raster and TIN.\nFor more information, read the ",(0,r.yg)("a",{parentName:"p",href:"https://www.esri.com/library/whitepapers/pdfs/shapefile.pdf"},"ESRI Shapefile Technical Description: An ESRI White Paper-July 1988")),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"ESRI prj files and WKT files")),(0,r.yg)("p",null,"A shapefile is typically accompanied by a ",(0,r.yg)("inlineCode",{parentName:"p"},".prj")," file that contains a Well known text (WKT) string which stores coordinate reference system information. Well known text (WKT) is a text markup language for representing vector geometry objects on a map. The format was originally defined by the Open Geospatial Consortium (OGC) and described in their Simple Feature Access specification, to which ESRI was a contributing member. The ",(0,r.yg)("a",{parentName:"p",href:"https://www.opengeospatial.org/standards/wkt-crs"},"current version of the WKT standard")," was published on August 13, 2019."),(0,r.yg)("p",null,"Not all ",(0,r.yg)("inlineCode",{parentName:"p"},".prj")," files contain the same parameters. There are also syntactical differences between ESRI WKT files and OGC WKT files. Visit the ",(0,r.yg)("a",{parentName:"p",href:"https://epsg.io/"},"EPSG.io")," to view examples of different WKT files. Here are examples of WKT files for EPSG:25832:"),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},(0,r.yg)("em",{parentName:"strong"},"Example of Well Known Text as HTML"))),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},'PROJCS["ETRS89 / UTM zone 32N",\n  GEOGCS["ETRS89",\n    DATUM["European_Terrestrial_Reference_System_1989",\n        SPHEROID["GRS 1980",6378137,298.257222101,\n            AUTHORITY["EPSG","7019"]],\n        TOWGS84[0,0,0,0,0,0,0],\n        AUTHORITY["EPSG","6258"]],\n    PRIMEM["Greenwich",0,\n        AUTHORITY["EPSG","8901"]],\n    UNIT["degree",0.0174532925199433,\n        AUTHORITY["EPSG","9122"]],\n    AUTHORITY["EPSG","4258"]],\nPROJECTION["Transverse_Mercator"],\nPARAMETER["latitude_of_origin",0],\nPARAMETER["central_meridian",9],\nPARAMETER["scale_factor",0.9996],\nPARAMETER["false_easting",500000],\nPARAMETER["false_northing",0],\nUNIT["metre",1,\n  AUTHORITY["EPSG","9001"]],\nAXIS["Easting",EAST],\nAXIS["Northing",NORTH],\nAUTHORITY["EPSG","25832"]]\n')),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},(0,r.yg)("em",{parentName:"strong"},"Example of OGC WKT"))),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},'PROJCS["ETRS89 / UTM zone 32N",\n  GEOGCS["ETRS89",\n    DATUM["European_Terrestrial_Reference_System_1989",\n      SPHEROID["GRS 1980",6378137,298.257222101,AUTHORITY["EPSG","7019"]],\n             TOWGS84[0,0,0,0,0,0,0],\n             AUTHORITY["EPSG","6258"]],\n           PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],\n           UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],\n  AUTHORITY["EPSG","4258"]],\nPROJECTION["Transverse_Mercator"],\nPARAMETER["latitude_of_origin",0],\nPARAMETER["central_meridian",9],\nPARAMETER["scale_factor",0.9996],\nPARAMETER["false_easting",500000],\nPARAMETER["false_northing",0],\nUNIT["metre",1,AUTHORITY["EPSG","9001"]],\nAXIS["Easting",EAST],\nAXIS["Northing",NORTH],\nAUTHORITY["EPSG","25832"]]\n')),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},(0,r.yg)("em",{parentName:"strong"},"Example of ESRI WKT"))),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},'PROJCS["ETRS89_UTM_zone_32N",\n  GEOGCS["GCS_ETRS_1989",\n    DATUM["D_ETRS_1989",\n           SPHEROID["GRS_1980",6378137,298.257222101]],\n          PRIMEM["Greenwich",0],\n          UNIT["Degree",0.017453292519943295]],\nPROJECTION["Transverse_Mercator"],\nPARAMETER["latitude_of_origin",0],\nPARAMETER["central_meridian",9],\nPARAMETER["scale_factor",0.9996],\nPARAMETER["false_easting",500000],\nPARAMETER["false_northing",0],\nUNIT["Meter",1]]\n')),(0,r.yg)("h3",{id:"datum-transformations"},(0,r.yg)("strong",{parentName:"h3"},"Datum transformations")),(0,r.yg)("p",null,"Datum transformations are required when your transformation from one coordinate system to another includes a geographic coordinate system. Datum transformations should be performed with caution because they can result in significant data shifts of 1 meter or more. There are several different methods used to perform datum transformation- Bursa-Wolf is one method."),(0,r.yg)("p",null,"The WKT parameter ",(0,r.yg)("inlineCode",{parentName:"p"},"TOWGS84")," is used to approximate a transformation from the horizontal datum to the WGS84 datum.\nThe original Simple Features specification of WKT does not specify ",(0,r.yg)("inlineCode",{parentName:"p"},"TOWGS84")," as a valid keyword. ESRI does not support the ",(0,r.yg)("inlineCode",{parentName:"p"},"TOWGS84")," parameter in WKT. Instead of using a fixed transformation, ESRI software asks the user to choose an appropriate transformation method when necessary, as does QGIS."),(0,r.yg)("p",null,"The current version of WKT has no backward compatibility with ",(0,r.yg)("inlineCode",{parentName:"p"},"TOWGS84"),". WKT descriptions of geodetic datums written to the OGC 01-009 specification are not readable by implementations of the current WKT specification if the optional ",(0,r.yg)("inlineCode",{parentName:"p"},"TOWGS84")," object is provided."),(0,r.yg)("h3",{id:"coordinate-reference-system-identification-in-haleconnect"},(0,r.yg)("strong",{parentName:"h3"},"Coordinate reference system identification in hale\xbbconnect")),(0,r.yg)("p",null,"hale\xbbconnect uses the open source Java GIS toolkit GeoTools to process spatial data. GeoTools, in turn, contains a copy of the ",(0,r.yg)("a",{parentName:"p",href:"http://www.epsg-registry.org/"},"EPSG database"),". When a shapefile is uploaded to the platform, hale\xbbconnect uses the GeoTools library to attempt to match the WKT contained in the ",(0,r.yg)("inlineCode",{parentName:"p"},".prj")," file to the CRS definitions in the EPSG database. If a match is found, the data is subsequently processed using the matched EPSG CRS code."),(0,r.yg)("p",null,"In some cases, GeoTools cannot determine the CRS definition based on the information contained in the WKT. To support GeoTools in finding the correct match, the user can add an ",(0,r.yg)("inlineCode",{parentName:"p"},"AUTHORITY")," parameter as the final parameter to the WKT file. GeoTools then uses the user-supplied EPSG code in the ",(0,r.yg)("inlineCode",{parentName:"p"},"AUTHORITY")," parameter to apply the CRS definition defined in the EPSG database to the shapefile. These definitions also contain the Bursa-Wolf parameters required for datum transformation from the CRS definitions in the EPSG database."),(0,r.yg)("h3",{id:"manually-adding-the-authority-parameter-to-an-esri-prj-file"},(0,r.yg)("strong",{parentName:"h3"},"Manually adding the AUTHORITY parameter to an ESRI prj file")),(0,r.yg)("p",null,"You can manually edit an ESRI ",(0,r.yg)("inlineCode",{parentName:"p"},".prj")," file to include the optional ",(0,r.yg)("inlineCode",{parentName:"p"},"AUTHORITY")," parameter. The parameter must be added as the final, terminating parameter in the file using the following pattern: ",(0,r.yg)("inlineCode",{parentName:"p"},'AUTHORITY["EPSG","25832"]'),". Although the use of the ",(0,r.yg)("inlineCode",{parentName:"p"},"AUTHORITY")," parameter is officially deprecated in the current version of WKT, for purposes of backward compatibility its use is still accepted."),(0,r.yg)("p",null,"In the current version of WKT, the ",(0,r.yg)("inlineCode",{parentName:"p"},"AUTHORITY")," object has been replaced by the ",(0,r.yg)("inlineCode",{parentName:"p"},"ID")," object. The identifier object is not as narrowly defined as ",(0,r.yg)("inlineCode",{parentName:"p"},"AUTHORITY")," was in previous versions."),(0,r.yg)("h3",{id:"axis-flip"},(0,r.yg)("strong",{parentName:"h3"},"Axis flip")),(0,r.yg)("p",null,"The root cause for many of the axis-flip problems users experience, is that the axis order of the geometries in the shapefile is longitude, latitude/Easting, Northing but the WKT definition in the ",(0,r.yg)("inlineCode",{parentName:"p"},".prj")," file describes a CRS that has latitude, longitude/Northing, Easting axis order. For example, WGS 84 = EPSG:4326."),(0,r.yg)("p",null,"This is problematic if no EPSG definition for the CRS with the axis order used in the shapefile exists, because no matching code can be provided for the ",(0,r.yg)("inlineCode",{parentName:"p"},"AUTHORITY"),' parameter. In these cases it is necessary to use the "Flip coordinate order" toggle to flip the axis order after publishing the dataset.'),(0,r.yg)("p",null,"In the end, the only way to handle axis order is to analyze the axis order of the shapefile geometries and determine if the axis order fits the CRS definition in the ",(0,r.yg)("inlineCode",{parentName:"p"},".prj")," file and act accordingly, i.e. either add an ",(0,r.yg)("inlineCode",{parentName:"p"},"AUTHORITY")," parameter to the ",(0,r.yg)("inlineCode",{parentName:"p"},".prj"),' file or utilize the "Flip coordinate order" toggle in hale\xbbconnect.'))}f.isMDXComponent=!0}}]);